import json
import streamlit as st
import os
import requests

IP = "192.168.1.3"

attacks2019 = {
    "UDP": [393, 321, 348, 321, 393, 344, 401, 348],
    "MSSQL": [678, 678, 678, 678, 678, 678, 1017, 678],
    "Benign": [0, 0, 0, 0, 0, 0, 0, 0],
    "Portmap": [211, 211, 211, 211, 211, 211, 237, 211],
    "Syn": [6, 6, 6, 6, 6, 6, 7, 6],
    "NetBIOS": [229, 229, 229, 229, 229, 229, 343, 229],
    "UDPLag": [581, 581, 581, 581, 581, 581, 871, 581],
    "LDAP": [1424, 1424, 1424, 1424, 1424, 1424, 2136, 1424],
    "DrDoS_DNS": [1472, 1472, 1472, 1472, 1472, 1472, 2208, 1472],
    "UDP-lag": [1472, 1472, 1472, 520, 1472, 1091, 1364, 1472],
    "WebDDoS": [0, 0, 0, 0, 0, 0, 0, 0],
    "TFTP": [516, 516, 516, 516, 516, 516, 774, 516],
    "DrDoS_UDP": [389, 330, 359, 330, 389, 353, 442, 359],
    "DrDoS_SNMP": [1376, 1376, 1376, 1376, 1376, 1376, 2064, 1376],
    "DrDoS_NetBIOS": [211, 211, 211, 211, 211, 211, 316, 211],
    "DrDoS_LDAP": [1248, 1248, 1248, 1248, 1248, 1248, 1872, 1248],
    "DrDoS_MSSQL": [462, 462, 462, 462, 462, 462, 693, 462],
    "DrDoS_NTP": [50, 50, 50, 50, 50, 50, 58, 50],
}

attacks2017 = {
    "BENIGN": [3, 0, 0, 3, 3, 3, 6, 6, 0, 0, 9, 0, 0, 33],
    "DDoS": [1293792, 11607, 1658, 143754, 1292730, 744, 5840, 1057, 1853, 3435230, 1163, 1658, 11607, 8192],
    "PortScan": [53,	6,	6,	53,	53,	0,	6,3.333333333,2.309401077,5.333333333,5,6,6,1024],
    "Bot": [70069.0, 134.0, 44.66666667, 11678.16667, 68138.0, 69331.0, 196.0, 42.75, 75.86407017, 5755.357143, 48.85714286, 44.66666667, 134.0, 8192.0],
    "Web Attack Brute Force": [5021059, 1414, 282, 502105, 4965658, 41863, 1050, 176, 317, 100787, 192, 282, 1414, 29200],
    "Web Attack XSS": [5419474.0, 0.0, 0.0, 1806491.333, 5418881.0, 5418881.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29200.0],
    "Web Attack Sql Injection": [41	,0	,0	,41,41,0,0,0,0,0,0,0,0,259],
    "Infiltration": [24006815, 210, 6, 347924, 18500000, 18500000, 1460, 192, 396, 157176, 195, 6, 210, 255],
    "FTP-Patator": [232, 0, 0, 116, 173, 232, 14, 7, 8, 65, 9, 0, 0, 229],
    "SSH-Patator": [508, 0, 0, 254, 473, 508, 0, 0, 0, 0, 0, 0, 0, 237],
    "DoS slowloris": [55134646	,0	,0	,27600000	,55100000	,55100000	,8,	4	,4.618802154,	21.33333333	,5.333333333,	0	,0	,229],
    "DoS Slowhttptest": [63129081, 0, 0, 10500000, 32100000, 32100000, 0, 0, 0, 0, 0, 0, 0, 29200],
    "DoS Hulk": [1878, 11595, 1932, 234, 577, 675, 4355, 1197, 1886, 3558249, 1330, 1932, 11595, 29200],
    "DoS GoldenEye": [5008837, 3525, 705, 626104, 5002306, 2615, 2077, 386, 747, 559146, 429, 705, 3525, 29200],
    "Heartbleed": [119259886, 7879536, 3768, 24478, 995232, 996222, 15928, 1620, 2427, 5894570, 1620, 3768, 7879536, 235],
}


st.title("Attacker")
year = st.selectbox("Select a year:", ["2017", "2019"])
actions = attacks2017.keys() if year == "2017" else attacks2019.keys()
action = st.selectbox("Select an action:", actions)

if st.button("Run Program"):
    if year == "2017":
        with open("./2017/run.json", "w") as f:
            json.dump({"IP": IP, "data": attacks2017[action]}, f)
        os.system("python ./2017/sender.py")
        requests.post("http://" + IP + ":5000/add", json={
            "data": ["2017", attacks2017[action]]
        })
    elif year == "2019":
        with open("./2019/run.json", "w") as f:
            json.dump({"IP": IP, "data": attacks2019[action]}, f)
        os.system("python ./2019/sender.py")
        requests.post("http://" + IP + ":5000/add", json={
            "data": ["2019", attacks2019[action]]
        })
